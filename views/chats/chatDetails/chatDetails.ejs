<%- include('../../includes/header', { title: 'Conversations', loggedIn: true }); %>
<%- include('../../includes/alert', { message: locals.message }); %>
<%- include('chatDetailsEditModal', { 
    contactFirstName: locals.conversation.contactFirstName,
    contactLastName: locals.conversation.contactLastName,
    formattedPhoneNumber: locals.conversation.formattedPhoneNumber,
    id: locals.conversation.id
}); %>
<div class="card mx-auto">
  <%- include('chatDetailsHeader', { conversation: locals.conversation }); %>  
  <div id="scrollable-messages-area" class="card-body">
    <!-- Loop through conversation messages -->
    <div id="messages-list">
      <% for (message of locals.conversation.Messages) { %>
        <% if (message.isInboundMessage) { %>
          <span class="text-muted timestamp inbound"><%= message.createdAtFormatted %></span>
          <span class="mb-3 message-bubble inbound">
            <%= message.messageContent %>
          </span>
        <% } else { %>
          <span class="text-muted timestamp outbound"><%= message.createdAtFormatted %></span>
          <span class="mb-3 message-bubble outbound">
            <%= message.messageContent %>
          </span>
        <% } %>
      <% } %>
    </div>
  </div>
    <%- include('chatDetailsFooter', {
        recipientNumber: locals.conversation.contactPhoneNumber,
        conversationId: locals.conversation.id
    }); %>
</div>
<!-- The div below saves the conversation's id so it can be
  accessed on the client side by the JavaScript file: conversation.js -->
<div id="custom-data" data-conversation-id=<%= locals.conversation.id %>></div>
<%- include('../../includes/footer'); %>
